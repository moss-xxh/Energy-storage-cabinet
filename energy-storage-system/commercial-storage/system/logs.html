<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥å¿—ç®¡ç† - å·¥å•†å‚¨èƒ½ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="../sidebar.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f3f4f6;
            color: #1f2937;
        }

        .content {
            padding: 2rem;
        }

        .page-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .search-filter-section {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .content-card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .search-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .search-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            white-space: nowrap;
        }

        .search-input {
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.875rem;
            min-width: 140px;
        }

        .search-input:focus {
            outline: none;
            border-color: #3562E3;
            box-shadow: 0 0 0 3px rgba(53, 98, 227, 0.1);
        }

        .search-button, .reset-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-button {
            background: #3562E3;
            color: white;
            border: 1px solid #3562E3;
        }

        .search-button:hover {
            background: #2951d3;
        }

        .reset-button {
            background: white;
            color: #6b7280;
            border: 1px solid #d1d5db;
        }

        .reset-button:hover {
            background: #f9fafb;
            color: #374151;
        }
        
        .logs-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-card.total {
            border-left: 4px solid #3b82f6;
        }

        .stat-card.error {
            border-left: 4px solid #ef4444;
        }

        .stat-card.warning {
            border-left: 4px solid #f59e0b;
        }

        .stat-card.info {
            border-left: 4px solid #10b981;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 14px;
            color: #64748b;
        }


        .table-action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 0;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.375rem 0.75rem;
            border: 1px solid;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn.secondary {
            background: white;
            color: #6b7280;
            border-color: #d1d5db;
        }

        .action-btn.secondary:hover {
            background: #f9fafb;
            color: #374151;
        }

        .device-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .device-table th {
            padding: 0.625rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.8125rem;
        }

        .device-table td {
            padding: 0.625rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.8125rem;
        }

        .device-table tbody tr:hover {
            background: #f8fafc;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 0;
        }

        #list-view-content {
            padding: 1.5rem;
        }

        .log-level {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .level-error {
            background: #fee2e2;
            color: #dc2626;
        }

        .level-warning {
            background: #fef3c7;
            color: #d97706;
        }

        .level-info {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .level-debug {
            background: #f3f4f6;
            color: #374151;
        }

        .level-success {
            background: #d1fae5;
            color: #059669;
        }

        .log-message {
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .log-message:hover {
            white-space: normal;
            overflow: visible;
        }

        .log-source {
            font-family: monospace;
            font-size: 12px;
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .btn-action {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-view {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .btn-download {
            background: #f0fdf4;
            color: #059669;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            padding: 1.5rem;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
        }

        .pagination button.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .real-time-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toggle-switch {
            position: relative;
            width: 40px;
            height: 20px;
            background: #d1d5db;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #3b82f6;
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(20px);
        }
    </style>
</head>
<body>
    <!-- ä¾§è¾¹æ å®¹å™¨ -->
    <div id="sidebar-container"></div>
<div class="main-content">

                <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <nav class="navbar">
            <div class="navbar-left">
                <button class="nav-button" onclick="toggleSidebar()">
                    <span>â˜°</span>
                </button>
                <button class="nav-button" onclick="goBack()" title="è¿”å›åœºæ™¯é€‰æ‹©">
                    <span>â†</span>
                </button>
                <h1 class="page-title">æ—¥å¿—ç®¡ç†</h1>
            </div>
            <div class="navbar-right">
                <button class="nav-button" onclick="toggleLanguage()">
                    <span>ğŸŒ</span>
                    <span id="lang-text">ä¸­æ–‡</span>
                </button>
                <button class="nav-button" onclick="toggleTheme()">
                    <span id="theme-icon">ğŸŒ™</span>
                </button>
                <div class="user-dropdown">
                    <button class="nav-button user-menu-btn" onclick="toggleUserMenu()">
                        <span>ğŸ‘¤</span>
                        <span>ç®¡ç†å‘˜</span>
                        <span class="dropdown-arrow">â–¼</span>
                    </button>
                    <div class="user-dropdown-menu" id="userDropdownMenu">
                        <div class="dropdown-item" onclick="showAccountInfo()">
                            <span>è´¦å·ä¿¡æ¯</span>
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-item logout" onclick="confirmLogout()">
                            <span>é€€å‡º</span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

<div class="content">
            <div class="page-content">
                <div class="page-header">
                </div>

                <!-- ç­›é€‰é¢æ¿ -->
                <div class="search-filter-section">
                    <div class="search-row">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div class="search-group">
                                    <label class="search-label">æ—¥å¿—çº§åˆ«ï¼š</label>
                                    <select class="search-input" id="log-level">
                                        <option value="">å…¨éƒ¨çº§åˆ«</option>
                                        <option value="error">é”™è¯¯</option>
                                        <option value="warning">è­¦å‘Š</option>
                                        <option value="info">ä¿¡æ¯</option>
                                        <option value="debug">è°ƒè¯•</option>
                                    </select>
                                </div>
                                <div class="search-group">
                                    <label class="search-label">æ—¥å¿—æºï¼š</label>
                                    <select class="search-input" id="log-source">
                                        <option value="">å…¨éƒ¨æ¥æº</option>
                                        <option value="system">ç³»ç»Ÿ</option>
                                        <option value="device">è®¾å¤‡</option>
                                        <option value="user">ç”¨æˆ·æ“ä½œ</option>
                                        <option value="api">APIè°ƒç”¨</option>
                                    </select>
                                </div>
                                <div class="search-group">
                                    <label class="search-label">æ—¶é—´èŒƒå›´ï¼š</label>
                                    <select class="search-input" id="time-range">
                                        <option value="today">ä»Šå¤©</option>
                                        <option value="week">æœ€è¿‘7å¤©</option>
                                        <option value="month">æœ€è¿‘30å¤©</option>
                                        <option value="custom">è‡ªå®šä¹‰</option>
                                    </select>
                                </div>
                                <div class="search-group">
                                    <label class="search-label">å…³é”®è¯ï¼š</label>
                                    <input type="text" class="search-input" id="keyword" placeholder="æœç´¢æ—¥å¿—å†…å®¹">
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="search-button" onclick="searchLogs()">
                                    <span>æœç´¢</span>
                                </button>
                                <button class="reset-button" onclick="resetSearch()">
                                    <span>é‡ç½®</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ—¥å¿—ç®¡ç†å¡ç‰‡ -->
                <div class="content-card">
                    <div class="table-action-bar">
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="action-btn secondary" onclick="exportLogs()">
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 1V9M4 6L7 9L10 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M1 10V12C1 12.5523 1.44772 13 2 13H12C12.5523 13 13 12.5523 13 12V10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                <span>å¯¼å‡ºæ—¥å¿—</span>
                            </button>
                        </div>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div class="real-time-toggle">
                                <div class="toggle-switch" onclick="toggleRealTime(this)">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ—¥å¿—åˆ—è¡¨ -->
                    <div id="list-view-content" class="table-container">
                        <table class="device-table">
                        <thead>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <th>æ—¶é—´</th>
                                <th>çº§åˆ«</th>
                                <th>æ¥æº</th>
                                <th>æ¶ˆæ¯</th>
                                <th>ç”¨æˆ·</th>
                                <th>IPåœ°å€</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:35:23</td>
                                <td><span class="log-level level-error">é”™è¯¯</span></td>
                                <td><span class="log-source">device.pcs</span></td>
                                <td class="log-message">PCS-01è®¾å¤‡é€šä¿¡è¶…æ—¶ï¼Œè¿æ¥å¤±è´¥</td>
                                <td>ç³»ç»Ÿ</td>
                                <td>192.168.1.100</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:32:15</td>
                                <td><span class="log-level level-warning">è­¦å‘Š</span></td>
                                <td><span class="log-source">system.auth</span></td>
                                <td class="log-message">ç”¨æˆ·å¼ å·¥ç¨‹å¸ˆè¿ç»­3æ¬¡ç™»å½•å¤±è´¥</td>
                                <td>å¼ å·¥ç¨‹å¸ˆ</td>
                                <td>192.168.1.105</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:30:08</td>
                                <td><span class="log-level level-info">ä¿¡æ¯</span></td>
                                <td><span class="log-source">user.operation</span></td>
                                <td class="log-message">ç”¨æˆ·æè¿ç»´æ‰§è¡Œäº†è®¾å¤‡é‡å¯æ“ä½œ</td>
                                <td>æè¿ç»´</td>
                                <td>192.168.1.102</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:28:45</td>
                                <td><span class="log-level level-success">æˆåŠŸ</span></td>
                                <td><span class="log-source">api.request</span></td>
                                <td class="log-message">æ•°æ®åˆ†ææŠ¥è¡¨ç”ŸæˆæˆåŠŸ</td>
                                <td>ç³»ç»Ÿ</td>
                                <td>127.0.0.1</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:25:12</td>
                                <td><span class="log-level level-debug">è°ƒè¯•</span></td>
                                <td><span class="log-source">system.monitor</span></td>
                                <td class="log-message">å®šæ—¶ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶125ms</td>
                                <td>ç³»ç»Ÿ</td>
                                <td>127.0.0.1</td>
                            </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let realTimeRefresh = false;
        let refreshInterval;

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
        });

        // æœç´¢æ—¥å¿—
        function searchLogs() {
            const level = document.getElementById('log-level').value;
            const source = document.getElementById('log-source').value;
            const timeRange = document.getElementById('time-range').value;
            const keyword = document.getElementById('keyword').value;
            
            console.log('æœç´¢æ—¥å¿—:', { level, source, timeRange, keyword });
            showMessage('æ—¥å¿—æœç´¢å®Œæˆ', 'success');
        }

        // é‡ç½®æœç´¢
        function resetSearch() {
            document.getElementById('log-level').value = '';
            document.getElementById('log-source').value = '';
            document.getElementById('time-range').value = 'today';
            document.getElementById('keyword').value = '';
            showMessage('æœç´¢æ¡ä»¶å·²é‡ç½®', 'info');
        }

        // åˆ‡æ¢å®æ—¶åˆ·æ–°
        function toggleRealTime(toggle) {
            realTimeRefresh = !realTimeRefresh;
            toggle.classList.toggle('active', realTimeRefresh);
            
            if (realTimeRefresh) {
                showMessage('å®æ—¶åˆ·æ–°å·²å¼€å¯', 'success');
                refreshInterval = setInterval(refreshLogs, 5000);
            } else {
                showMessage('å®æ—¶åˆ·æ–°å·²å…³é—­', 'info');
                clearInterval(refreshInterval);
            }
        }

        // åˆ·æ–°æ—¥å¿—
        function refreshLogs() {
            console.log('åˆ·æ–°æ—¥å¿—æ•°æ®');
            // è¿™é‡Œåº”è¯¥ä»æœåŠ¡å™¨è·å–æœ€æ–°æ—¥å¿—
        }

        // æŸ¥çœ‹æ—¥å¿—è¯¦æƒ…
        function viewLogDetail(logId) {
            showLogDetailModal(logId);
        }

        // æ˜¾ç¤ºæ—¥å¿—è¯¦æƒ…æ¨¡æ€æ¡†
        function showLogDetailModal(logId) {
            // æ¨¡æ‹Ÿæ—¥å¿—è¯¦æƒ…æ•°æ®
            const logDetails = {
                'log1': {
                    id: 'log1',
                    time: '2024-01-24 14:35:23',
                    level: 'ERROR',
                    source: 'device.pcs',
                    message: 'PCS-01è®¾å¤‡é€šä¿¡è¶…æ—¶ï¼Œè¿æ¥å¤±è´¥',
                    user: 'ç³»ç»Ÿ',
                    ip: '192.168.1.100',
                    details: 'TCPè¿æ¥è¶…æ—¶ï¼Œè®¾å¤‡å¯èƒ½ç¦»çº¿æˆ–ç½‘ç»œå¼‚å¸¸ã€‚é”™è¯¯ä»£ç ï¼šTIMEOUT_001',
                    stack: 'at DeviceConnection.connect(device.js:123)\nat DeviceManager.initialize(manager.js:45)\nat System.startup(system.js:12)'
                },
                'log2': {
                    id: 'log2',
                    time: '2024-01-24 14:32:15',
                    level: 'WARNING',
                    source: 'system.auth',
                    message: 'ç”¨æˆ·å¼ å·¥ç¨‹å¸ˆè¿ç»­3æ¬¡ç™»å½•å¤±è´¥',
                    user: 'å¼ å·¥ç¨‹å¸ˆ',
                    ip: '192.168.1.105',
                    details: 'ç”¨æˆ·åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡ç™»å½•å¤±è´¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚å»ºè®®æ£€æŸ¥å¯†ç æˆ–è´¦æˆ·çŠ¶æ€ã€‚',
                    stack: ''
                },
                'log3': {
                    id: 'log3',
                    time: '2024-01-24 14:30:08',
                    level: 'INFO',
                    source: 'user.operation',
                    message: 'ç”¨æˆ·æè¿ç»´æ‰§è¡Œäº†è®¾å¤‡é‡å¯æ“ä½œ',
                    user: 'æè¿ç»´',
                    ip: '192.168.1.102',
                    details: 'è®¾å¤‡ID: DEV-001ï¼Œé‡å¯ç±»å‹: è½¯é‡å¯ï¼Œæ“ä½œè€—æ—¶: 15ç§’',
                    stack: ''
                },
                'log4': {
                    id: 'log4',
                    time: '2024-01-24 14:28:45',
                    level: 'SUCCESS',
                    source: 'api.request',
                    message: 'æ•°æ®åˆ†ææŠ¥è¡¨ç”ŸæˆæˆåŠŸ',
                    user: 'ç³»ç»Ÿ',
                    ip: '127.0.0.1',
                    details: 'æŠ¥è¡¨ç±»å‹: èƒ½è€—åˆ†æï¼Œæ•°æ®èŒƒå›´: 2024-01-01 è‡³ 2024-01-24ï¼Œæ–‡ä»¶å¤§å°: 2.5MB',
                    stack: ''
                },
                'log5': {
                    id: 'log5',
                    time: '2024-01-24 14:25:12',
                    level: 'DEBUG',
                    source: 'system.monitor',
                    message: 'å®šæ—¶ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶125ms',
                    user: 'ç³»ç»Ÿ',
                    ip: '127.0.0.1',
                    details: 'ä»»åŠ¡åç§°: æ•°æ®é‡‡é›†ä»»åŠ¡ï¼Œæ‰§è¡Œå‘¨æœŸ: 5åˆ†é’Ÿï¼Œå¤„ç†è®°å½•æ•°: 1024',
                    stack: ''
                }
            };

            const log = logDetails[logId] || {};
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="min-width: 600px; max-width: 800px;">
                    <div class="modal-header">
                        <h2 class="modal-title">æ—¥å¿—è¯¦æƒ…</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 1rem 0;">
                        <div class="log-detail-grid">
                            <div class="detail-row">
                                <span class="detail-label">æ—¶é—´ï¼š</span>
                                <span class="detail-value">${log.time || ''}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">çº§åˆ«ï¼š</span>
                                <span class="detail-value">
                                    <span class="log-level level-${log.level?.toLowerCase() || 'info'}">${log.level || ''}</span>
                                </span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">æ¥æºï¼š</span>
                                <span class="detail-value log-source">${log.source || ''}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">ç”¨æˆ·ï¼š</span>
                                <span class="detail-value">${log.user || ''}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">IPåœ°å€ï¼š</span>
                                <span class="detail-value">${log.ip || ''}</span>
                            </div>
                            <div class="detail-row full-width">
                                <span class="detail-label">æ¶ˆæ¯ï¼š</span>
                                <span class="detail-value">${log.message || ''}</span>
                            </div>
                            <div class="detail-row full-width">
                                <span class="detail-label">è¯¦ç»†ä¿¡æ¯ï¼š</span>
                                <span class="detail-value">${log.details || 'æ— é¢å¤–ä¿¡æ¯'}</span>
                            </div>
                            ${log.stack ? `
                                <div class="detail-row full-width">
                                    <span class="detail-label">å †æ ˆä¿¡æ¯ï¼š</span>
                                    <pre class="detail-value stack-trace">${log.stack}</pre>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">å…³é—­</button>
                    </div>
                </div>
            `;
            
            // æ·»åŠ æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                .modal {
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    align-items: center;
                    justify-content: center;
                }
                .modal-content {
                    background: white;
                    border-radius: 8px;
                    padding: 2rem;
                    max-width: 90vw;
                    max-height: 90vh;
                    overflow-y: auto;
                }
                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 1.5rem;
                    padding-bottom: 1rem;
                    border-bottom: 1px solid #e5e7eb;
                }
                .modal-title {
                    font-size: 1.25rem;
                    font-weight: 600;
                    color: #1f2937;
                }
                .close-btn {
                    background: none;
                    border: none;
                    font-size: 1.5rem;
                    cursor: pointer;
                    color: #6b7280;
                    padding: 0;
                    line-height: 1;
                }
                .close-btn:hover {
                    color: #374151;
                }
                .modal-footer {
                    display: flex;
                    justify-content: flex-end;
                    gap: 1rem;
                    margin-top: 2rem;
                    padding-top: 1rem;
                    border-top: 1px solid #e5e7eb;
                }
                .log-detail-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 1rem;
                }
                .detail-row {
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                }
                .detail-row.full-width {
                    grid-column: 1 / -1;
                }
                .detail-label {
                    font-weight: 600;
                    color: #374151;
                    font-size: 0.875rem;
                }
                .detail-value {
                    color: #1f2937;
                    font-size: 0.875rem;
                    word-break: break-word;
                }
                .stack-trace {
                    background: #f1f5f9;
                    padding: 0.75rem;
                    border-radius: 4px;
                    font-family: monospace;
                    font-size: 0.8125rem;
                    white-space: pre-wrap;
                    overflow-x: auto;
                }
            `;
            
            document.head.appendChild(style);
            document.body.appendChild(modal);
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                    style.remove();
                }
            });
        }

        // æ¸…ç©ºæ—¥å¿—
        function clearLogs() {
            showConfirmDialog(
                'æ¸…ç©ºæ—¥å¿—',
                'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ç³»ç»Ÿæ—¥å¿—å—ï¼Ÿ',
                'æ¸…ç©ºåæ‰€æœ‰æ—¥å¿—æ•°æ®å°†æ°¸ä¹…ä¸¢å¤±ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ï¼',
                () => {
                    console.log('æ¸…ç©ºæ—¥å¿—');
                    showMessage('æ—¥å¿—å·²æ¸…ç©º', 'success');
                },
                'danger'
            );
        }

        // å¯¼å‡ºæ—¥å¿—
        function exportLogs() {
            console.log('å¯¼å‡ºæ—¥å¿—');
            showMessage('æ—¥å¿—å¯¼å‡ºä¸­...', 'info');
            
            setTimeout(() => {
                showMessage('æ—¥å¿—å¯¼å‡ºå®Œæˆ', 'success');
            }, 2000);
        }

        // åˆ†é¡µ
        function changePage(page) {
            console.log('åˆ‡æ¢åˆ°é¡µé¢:', page);
        }

        // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
        function showConfirmDialog(title, message, warning, callback, type = 'primary') {
            // åˆ›å»ºæ¨¡æ€æ¡†å…ƒç´ 
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="min-width: 400px;">
                    <div class="modal-header">
                        <h2 class="modal-title">${title}</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 1rem 0;">
                        <div style="font-size: 0.9rem; color: #374151; line-height: 1.5;">${message}</div>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: #fef2f2; border: 1px solid #fecaca; border-radius: 6px; font-size: 0.875rem; color: #dc2626;">${warning}</div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">å–æ¶ˆ</button>
                        <button type="button" class="btn ${type === 'danger' ? 'btn-danger' : 'btn-primary'}" onclick="confirmAction()">ç¡®è®¤</button>
                    </div>
                </div>
            `;
            
            // æ·»åŠ æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                .modal {
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    align-items: center;
                    justify-content: center;
                }
                .modal-content {
                    background: white;
                    border-radius: 8px;
                    padding: 2rem;
                    max-width: 90vw;
                    max-height: 90vh;
                    overflow-y: auto;
                }
                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 1.5rem;
                    padding-bottom: 1rem;
                    border-bottom: 1px solid #e5e7eb;
                }
                .modal-title {
                    font-size: 1.25rem;
                    font-weight: 600;
                    color: #1f2937;
                }
                .close-btn {
                    background: none;
                    border: none;
                    font-size: 1.5rem;
                    cursor: pointer;
                    color: #6b7280;
                    padding: 0;
                    line-height: 1;
                }
                .close-btn:hover {
                    color: #374151;
                }
                .modal-footer {
                    display: flex;
                    justify-content: flex-end;
                    gap: 1rem;
                    margin-top: 2rem;
                    padding-top: 1rem;
                    border-top: 1px solid #e5e7eb;
                }
                .btn-danger {
                    background: #ef4444;
                    color: white;
                }
                .btn-danger:hover {
                    background: #dc2626;
                }
            `;
            
            // ç¡®è®¤æ“ä½œå‡½æ•°
            window.confirmAction = function() {
                callback();
                modal.remove();
                style.remove();
                delete window.confirmAction;
            };
            
            document.head.appendChild(style);
            document.body.appendChild(modal);
        }

        // æ¶ˆæ¯æç¤º
        function showMessage(message, type) {
            const messageEl = document.createElement('div');
            messageEl.className = `message ${type}`;
            messageEl.textContent = message;
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 6px;
                color: white;
                font-weight: 500;
                z-index: 9999;
                transition: all 0.3s ease;
                ${type === 'success' ? 'background: #10b981;' : 
                  type === 'error' ? 'background: #ef4444;' : 
                  'background: #3b82f6;'}
            `;
            
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.style.opacity = '0';
                messageEl.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(messageEl)) {
                        document.body.removeChild(messageEl);
                    }
                }, 300);
            }, 3000);
        }

        // åˆ‡æ¢ç”¨æˆ·èœå•
        function toggleUserMenu() {
            const menu = document.getElementById('userDropdownMenu');
            const btn = document.querySelector('.user-menu-btn');
            
            menu.classList.toggle('show');
            btn.classList.toggle('active');
        }

        // æ˜¾ç¤ºè´¦å·ä¿¡æ¯
        function showAccountInfo() {
            toggleUserMenu(); // å…³é—­ä¸‹æ‹‰èœå•
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="min-width: 500px; max-width: 600px;">
                    <div class="modal-header">
                        <h2 class="modal-title">è´¦å·ä¿¡æ¯</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 1rem 0;">
                        <div class="account-info-grid">
                            <div class="info-section">
                                <h3 class="section-title">åŸºæœ¬ä¿¡æ¯</h3>
                                <div class="info-row">
                                    <span class="info-label">ç”¨æˆ·åï¼š</span>
                                    <span class="info-value">admin</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">å§“åï¼š</span>
                                    <span class="info-value">ç®¡ç†å‘˜</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">é‚®ç®±ï¼š</span>
                                    <span class="info-value">admin@company.com</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">æ‰‹æœºï¼š</span>
                                    <span class="info-value">138-0000-0000</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">è§’è‰²ï¼š</span>
                                    <span class="info-value">
                                        <span class="role-badge">ç³»ç»Ÿç®¡ç†å‘˜</span>
                                    </span>
                                </div>
                            </div>
                            
                            <div class="info-section">
                                <h3 class="section-title">ç™»å½•ä¿¡æ¯</h3>
                                <div class="info-row">
                                    <span class="info-label">æœ€åç™»å½•ï¼š</span>
                                    <span class="info-value">2024-01-24 14:30:00</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">ç™»å½•IPï¼š</span>
                                    <span class="info-value">192.168.1.100</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">åˆ›å»ºæ—¶é—´ï¼š</span>
                                    <span class="info-value">2024-01-01 09:00:00</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">è´¦å·çŠ¶æ€ï¼š</span>
                                    <span class="info-value">
                                        <span class="status-badge enabled">æ­£å¸¸</span>
                                    </span>
                                </div>
                            </div>
                            
                            <div class="info-section full-width">
                                <h3 class="section-title">å®‰å…¨è®¾ç½®</h3>
                                <div class="security-actions">
                                    <button class="btn btn-secondary" onclick="changePassword()">ä¿®æ”¹å¯†ç </button>
                                    <button class="btn btn-secondary" onclick="updateProfile()">ç¼–è¾‘ä¿¡æ¯</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">å…³é—­</button>
                    </div>
                </div>
            `;
            
            // æ·»åŠ æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                .account-info-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 2rem;
                }
                .info-section {
                    display: flex;
                    flex-direction: column;
                    gap: 1rem;
                }
                .info-section.full-width {
                    grid-column: 1 / -1;
                }
                .section-title {
                    font-size: 1rem;
                    font-weight: 600;
                    color: #1f2937;
                    margin-bottom: 0.5rem;
                    padding-bottom: 0.5rem;
                    border-bottom: 1px solid #f1f5f9;
                }
                .info-row {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 0.5rem 0;
                }
                .info-label {
                    font-weight: 500;
                    color: #6b7280;
                    font-size: 0.875rem;
                }
                .info-value {
                    color: #1f2937;
                    font-size: 0.875rem;
                    font-weight: 500;
                }
                .role-badge {
                    display: inline-flex;
                    align-items: center;
                    padding: 4px 12px;
                    border-radius: 20px;
                    font-size: 12px;
                    font-weight: 500;
                    background: #eff6ff;
                    color: #1d4ed8;
                }
                .status-badge.enabled {
                    display: inline-flex;
                    align-items: center;
                    padding: 4px 12px;
                    border-radius: 20px;
                    font-size: 12px;
                    font-weight: 500;
                    background: #d1fae5;
                    color: #059669;
                }
                .security-actions {
                    display: flex;
                    gap: 1rem;
                    margin-top: 1rem;
                }
            `;
            
            document.head.appendChild(style);
            document.body.appendChild(modal);
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                    style.remove();
                }
            });
        }

        // ä¿®æ”¹å¯†ç 
        function changePassword() {
            showMessage('ä¿®æ”¹å¯†ç åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // æ›´æ–°èµ„æ–™
        function updateProfile() {
            showMessage('ç¼–è¾‘ä¿¡æ¯åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // ç¡®è®¤é€€å‡º
        function confirmLogout() {
            toggleUserMenu(); // å…³é—­ä¸‹æ‹‰èœå•
            
            showConfirmDialog(
                'é€€å‡ºç™»å½•',
                'ç¡®å®šè¦é€€å‡ºå½“å‰è´¦å·å—ï¼Ÿ',
                'é€€å‡ºåæ‚¨éœ€è¦é‡æ–°ç™»å½•æ‰èƒ½ç»§ç»­ä½¿ç”¨ç³»ç»Ÿã€‚',
                () => {
                    // æ¨¡æ‹Ÿé€€å‡ºæ“ä½œ
                    showMessage('æ­£åœ¨é€€å‡º...', 'info');
                    setTimeout(() => {
                        window.location.href = '/login.html'; // è·³è½¬åˆ°ç™»å½•é¡µé¢
                    }, 1000);
                },
                'primary'
            );
        }

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­ä¸‹æ‹‰èœå•
        document.addEventListener('click', function(e) {
            const userDropdown = document.querySelector('.user-dropdown');
            const menu = document.getElementById('userDropdownMenu');
            const btn = document.querySelector('.user-menu-btn');
            
            if (userDropdown && !userDropdown.contains(e.target)) {
                menu.classList.remove('show');
                btn.classList.remove('active');
            }
        });
    </script>

    <!-- å¼•å…¥ä¾§è¾¹æ è„šæœ¬ -->
    <script src="../sidebar.js"></script>

    <style>
        /* ç§»åŠ¨ç«¯èœå•æŒ‰é’®æ ·å¼ */
        @media (max-width: 768px) {
            .menu-toggle {
                display: block !important;
            }
        }
    
        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .navbar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 2rem;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .page-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-button {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            transition: all 150ms ease;
        }

        .nav-button:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        /* ç”¨æˆ·ä¸‹æ‹‰èœå•æ ·å¼ */
        .user-dropdown {
            position: relative;
        }

        .user-menu-btn {
            position: relative;
        }

        .dropdown-arrow {
            font-size: 0.75rem;
            transition: transform 0.2s ease;
        }

        .user-menu-btn.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .user-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            min-width: 200px;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
        }

        .user-dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            cursor: pointer;
            color: #374151;
            font-size: 0.875rem;
            transition: background-color 0.15s ease;
        }

        .dropdown-item:hover {
            background: #f8fafc;
        }

        .dropdown-item.logout:hover {
            background: #fef2f2;
            color: #dc2626;
        }

        .dropdown-divider {
            height: 1px;
            background: #e2e8f0;
            margin: 0.25rem 0;
        }
    </style>

    <script>
        // ç”¨æˆ·ä¸‹æ‹‰èœå•åŠŸèƒ½
        function toggleUserMenu() {
            console.log('toggleUserMenu called'); // è°ƒè¯•ç”¨
            const dropdown = document.getElementById('userDropdownMenu');
            const button = document.querySelector('.user-menu-btn');
            
            if (dropdown && button) {
                dropdown.classList.toggle('show');
                button.classList.toggle('active');
                console.log('Menu toggled', dropdown.classList.contains('show')); // è°ƒè¯•ç”¨
            } else {
                console.log('Dropdown or button not found'); // è°ƒè¯•ç”¨
            }
        }

        // æ˜¾ç¤ºè´¦å·ä¿¡æ¯
        function showAccountInfo() {
            console.log('showAccountInfo called'); // è°ƒè¯•ç”¨
            document.getElementById('userDropdownMenu').classList.remove('show');
            document.querySelector('.user-menu-btn').classList.remove('active');
            
            // æ˜¾ç¤ºç°æœ‰çš„è´¦å·ä¿¡æ¯æ¨¡æ€æ¡†
            const accountModal = document.getElementById('accountInfoModal');
            if (accountModal) {
                accountModal.classList.add('show');
            } else {
                console.log('Account modal not found, using existing modal'); // è°ƒè¯•ç”¨
                // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¸“é—¨çš„è´¦å·ä¿¡æ¯æ¨¡æ€æ¡†ï¼Œä½¿ç”¨ç°æœ‰çš„æ¨¡æ€æ¡†
                showExistingAccountInfo();
            }
        }

        // æ˜¾ç¤ºç°æœ‰çš„è´¦å·ä¿¡æ¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
        function showExistingAccountInfo() {
            // æŸ¥çœ‹æ˜¯å¦æœ‰ç°æœ‰çš„è´¦å·ä¿¡æ¯æ˜¾ç¤ºåŠŸèƒ½
            alert('è´¦å·ä¿¡æ¯åŠŸèƒ½å¼€å‘ä¸­');
        }

        // ç¡®è®¤é€€å‡º
        function confirmLogout() {
            console.log('confirmLogout called'); // è°ƒè¯•ç”¨
            document.getElementById('userDropdownMenu').classList.remove('show');
            document.querySelector('.user-menu-btn').classList.remove('active');
            
            if (confirm('æ‚¨ç¡®å®šè¦é€€å‡ºç³»ç»Ÿå—ï¼Ÿ')) {
                // è¿™é‡Œåº”è¯¥è°ƒç”¨åç«¯APIé€€å‡ºç™»å½•
                alert('æ­£åœ¨é€€å‡º...');
                setTimeout(() => {
                    window.location.href = '../../index.html';
                }, 1000);
            }
        }

        // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰èœå•
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('userDropdownMenu');
            const button = document.querySelector('.user-menu-btn');
            
            if (dropdown && button && !button.contains(event.target)) {
                dropdown.classList.remove('show');
                button.classList.remove('active');
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, checking elements');
            const dropdown = document.getElementById('userDropdownMenu');
            const button = document.querySelector('.user-menu-btn');
            console.log('Dropdown found:', !!dropdown);
            console.log('Button found:', !!button);
        });
    </script>

</body>
</html>