<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êó•ÂøóÁÆ°ÁêÜ - Â∑•ÂïÜÂÇ®ËÉΩÁÆ°ÁêÜÁ≥ªÁªü</title>
    <link rel="stylesheet" href="../sidebar.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f3f4f6;
            color: #1f2937;
        }

        .content {
            padding: 2rem;
        }

        .page-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .search-filter-section {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .content-card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .search-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .search-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            white-space: nowrap;
        }

        .search-input {
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.875rem;
            min-width: 140px;
        }

        .search-input:focus {
            outline: none;
            border-color: #3562E3;
            box-shadow: 0 0 0 3px rgba(53, 98, 227, 0.1);
        }

        .search-button, .reset-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-button {
            background: #3562E3;
            color: white;
            border: 1px solid #3562E3;
        }

        .search-button:hover {
            background: #2951d3;
        }

        .reset-button {
            background: white;
            color: #6b7280;
            border: 1px solid #d1d5db;
        }

        .reset-button:hover {
            background: #f9fafb;
            color: #374151;
        }
        
        .logs-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-card.total {
            border-left: 4px solid #3b82f6;
        }

        .stat-card.error {
            border-left: 4px solid #ef4444;
        }

        .stat-card.warning {
            border-left: 4px solid #f59e0b;
        }

        .stat-card.info {
            border-left: 4px solid #10b981;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 14px;
            color: #64748b;
        }


        .table-action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 0;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.375rem 0.75rem;
            border: 1px solid;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn.secondary {
            background: white;
            color: #6b7280;
            border-color: #d1d5db;
        }

        .action-btn.secondary:hover {
            background: #f9fafb;
            color: #374151;
        }

        .device-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .device-table th {
            padding: 0.625rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.8125rem;
        }

        .device-table td {
            padding: 0.625rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.8125rem;
        }

        .device-table tbody tr:hover {
            background: #f8fafc;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 0;
        }

        #list-view-content {
            padding: 1.5rem;
        }

        .log-level {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .level-error {
            background: #fee2e2;
            color: #dc2626;
        }

        .level-warning {
            background: #fef3c7;
            color: #d97706;
        }

        .level-info {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .level-debug {
            background: #f3f4f6;
            color: #374151;
        }

        .level-success {
            background: #d1fae5;
            color: #059669;
        }

        .log-message {
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .log-message:hover {
            white-space: normal;
            overflow: visible;
        }

        .log-source {
            font-family: monospace;
            font-size: 12px;
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .btn-action {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-view {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .btn-download {
            background: #f0fdf4;
            color: #059669;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            padding: 1.5rem;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
        }

        .pagination button.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .real-time-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toggle-switch {
            position: relative;
            width: 40px;
            height: 20px;
            background: #d1d5db;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #3b82f6;
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(20px);
        }
    </style>
</head>
<body>
    <!-- ‰æßËæπÊ†èÂÆπÂô® -->
    <div id="sidebar-container"></div>
<div class="main-content">

                <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
        <nav class="navbar">
            <div class="navbar-left">
                <button class="nav-button" onclick="toggleSidebar()">
                    <span>‚ò∞</span>
                </button>
                <button class="nav-button" onclick="goBack()" title="ËøîÂõûÂú∫ÊôØÈÄâÊã©">
                    <span>‚Üê</span>
                </button>
                <h1 class="page-title">Êó•ÂøóÁÆ°ÁêÜ</h1>
            </div>
            <div class="navbar-right">
                <button class="nav-button" onclick="toggleLanguage()">
                    <span>üåê</span>
                    <span id="lang-text">‰∏≠Êñá</span>
                </button>
                <button class="nav-button" onclick="toggleTheme()">
                    <span id="theme-icon">üåô</span>
                </button>
                <div class="user-dropdown">
                    <button class="nav-button user-menu-btn" onclick="toggleUserMenu()">
                        <span>üë§</span>
                        <span>ÁÆ°ÁêÜÂëò</span>
                        <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <div class="user-dropdown-menu" id="userDropdownMenu">
                        <div class="dropdown-item" onclick="showAccountInfo()">
                            <span>Ë¥¶Âè∑‰ø°ÊÅØ</span>
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-item logout" onclick="confirmLogout()">
                            <span>ÈÄÄÂá∫</span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

<div class="content">
            <div class="page-content">
                <div class="page-header">
                </div>

                <!-- Á≠õÈÄâÈù¢Êùø -->
                <div class="search-filter-section">
                    <div class="search-row">
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div class="search-group">
                                    <label class="search-label">Êó•ÂøóÁ∫ßÂà´Ôºö</label>
                                    <select class="search-input" id="log-level">
                                        <option value="">ÂÖ®ÈÉ®Á∫ßÂà´</option>
                                        <option value="error">ÈîôËØØ</option>
                                        <option value="warning">Ë≠¶Âëä</option>
                                        <option value="info">‰ø°ÊÅØ</option>
                                        <option value="debug">Ë∞ÉËØï</option>
                                    </select>
                                </div>
                                <div class="search-group">
                                    <label class="search-label">Êó•ÂøóÊ∫êÔºö</label>
                                    <select class="search-input" id="log-source">
                                        <option value="">ÂÖ®ÈÉ®Êù•Ê∫ê</option>
                                        <option value="system">Á≥ªÁªü</option>
                                        <option value="device">ËÆæÂ§á</option>
                                        <option value="user">Áî®Êà∑Êìç‰Ωú</option>
                                        <option value="api">APIË∞ÉÁî®</option>
                                    </select>
                                </div>
                                <div class="search-group">
                                    <label class="search-label">Êó∂Èó¥ËåÉÂõ¥Ôºö</label>
                                    <select class="search-input" id="time-range">
                                        <option value="today">‰ªäÂ§©</option>
                                        <option value="week">ÊúÄËøë7Â§©</option>
                                        <option value="month">ÊúÄËøë30Â§©</option>
                                        <option value="custom">Ëá™ÂÆö‰πâ</option>
                                    </select>
                                </div>
                                <div class="search-group">
                                    <label class="search-label">ÂÖ≥ÈîÆËØçÔºö</label>
                                    <input type="text" class="search-input" id="keyword" placeholder="ÊêúÁ¥¢Êó•ÂøóÂÜÖÂÆπ">
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="search-button" onclick="searchLogs()">
                                    <span>ÊêúÁ¥¢</span>
                                </button>
                                <button class="reset-button" onclick="resetSearch()">
                                    <span>ÈáçÁΩÆ</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Êó•ÂøóÁÆ°ÁêÜÂç°Áâá -->
                <div class="content-card">
                    <div class="table-action-bar">
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="action-btn secondary" onclick="exportLogs()">
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 1V9M4 6L7 9L10 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M1 10V12C1 12.5523 1.44772 13 2 13H12C12.5523 13 13 12.5523 13 12V10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                <span>ÂØºÂá∫Êó•Âøó</span>
                            </button>
                        </div>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div class="real-time-toggle">
                                <div class="toggle-switch" onclick="toggleRealTime(this)">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Êó•ÂøóÂàóË°® -->
                    <div id="list-view-content" class="table-container">
                        <table class="device-table">
                        <thead>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <th>Êó∂Èó¥</th>
                                <th>Á∫ßÂà´</th>
                                <th>Êù•Ê∫ê</th>
                                <th>Ê∂àÊÅØ</th>
                                <th>Áî®Êà∑</th>
                                <th>IPÂú∞ÂùÄ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:35:23</td>
                                <td><span class="log-level level-error">ÈîôËØØ</span></td>
                                <td><span class="log-source">device.pcs</span></td>
                                <td class="log-message">PCS-01ËÆæÂ§áÈÄö‰ø°Ë∂ÖÊó∂ÔºåËøûÊé•Â§±Ë¥•</td>
                                <td>Á≥ªÁªü</td>
                                <td>192.168.1.100</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:32:15</td>
                                <td><span class="log-level level-warning">Ë≠¶Âëä</span></td>
                                <td><span class="log-source">system.auth</span></td>
                                <td class="log-message">Áî®Êà∑Âº†Â∑•Á®ãÂ∏àËøûÁª≠3Ê¨°ÁôªÂΩïÂ§±Ë¥•</td>
                                <td>Âº†Â∑•Á®ãÂ∏à</td>
                                <td>192.168.1.105</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:30:08</td>
                                <td><span class="log-level level-info">‰ø°ÊÅØ</span></td>
                                <td><span class="log-source">user.operation</span></td>
                                <td class="log-message">Áî®Êà∑ÊùéËøêÁª¥ÊâßË°å‰∫ÜËÆæÂ§áÈáçÂêØÊìç‰Ωú</td>
                                <td>ÊùéËøêÁª¥</td>
                                <td>192.168.1.102</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:28:45</td>
                                <td><span class="log-level level-success">ÊàêÂäü</span></td>
                                <td><span class="log-source">api.request</span></td>
                                <td class="log-message">Êï∞ÊçÆÂàÜÊûêÊä•Ë°®ÁîüÊàêÊàêÂäü</td>
                                <td>Á≥ªÁªü</td>
                                <td>127.0.0.1</td>
                            </tr>
                            <tr onclick="viewLogDetail('log1')" style="cursor: pointer;">
                                <td>2024-01-24 14:25:12</td>
                                <td><span class="log-level level-debug">Ë∞ÉËØï</span></td>
                                <td><span class="log-source">system.monitor</span></td>
                                <td class="log-message">ÂÆöÊó∂‰ªªÂä°ÊâßË°åÂÆåÊàêÔºåËÄóÊó∂125ms</td>
                                <td>Á≥ªÁªü</td>
                                <td>127.0.0.1</td>
                            </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let realTimeRefresh = false;
        let refreshInterval;

        // È°µÈù¢ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
        });

        // ÊêúÁ¥¢Êó•Âøó
        function searchLogs() {
            const level = document.getElementById('log-level').value;
            const source = document.getElementById('log-source').value;
            const timeRange = document.getElementById('time-range').value;
            const keyword = document.getElementById('keyword').value;
            
            console.log('ÊêúÁ¥¢Êó•Âøó:', { level, source, timeRange, keyword });
            showMessage('Êó•ÂøóÊêúÁ¥¢ÂÆåÊàê', 'success');
        }

        // ÈáçÁΩÆÊêúÁ¥¢
        function resetSearch() {
            document.getElementById('log-level').value = '';
            document.getElementById('log-source').value = '';
            document.getElementById('time-range').value = 'today';
            document.getElementById('keyword').value = '';
            showMessage('ÊêúÁ¥¢Êù°‰ª∂Â∑≤ÈáçÁΩÆ', 'info');
        }

        // ÂàáÊç¢ÂÆûÊó∂Âà∑Êñ∞
        function toggleRealTime(toggle) {
            realTimeRefresh = !realTimeRefresh;
            toggle.classList.toggle('active', realTimeRefresh);
            
            if (realTimeRefresh) {
                showMessage('ÂÆûÊó∂Âà∑Êñ∞Â∑≤ÂºÄÂêØ', 'success');
                refreshInterval = setInterval(refreshLogs, 5000);
            } else {
                showMessage('ÂÆûÊó∂Âà∑Êñ∞Â∑≤ÂÖ≥Èó≠', 'info');
                clearInterval(refreshInterval);
            }
        }

        // Âà∑Êñ∞Êó•Âøó
        function refreshLogs() {
            console.log('Âà∑Êñ∞Êó•ÂøóÊï∞ÊçÆ');
            // ËøôÈáåÂ∫îËØ•‰ªéÊúçÂä°Âô®Ëé∑ÂèñÊúÄÊñ∞Êó•Âøó
        }

        // Êü•ÁúãÊó•ÂøóËØ¶ÊÉÖ
        function viewLogDetail(logId) {
            showLogDetailModal(logId);
        }

        // ÊòæÁ§∫Êó•ÂøóËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü
        function showLogDetailModal(logId) {
            // Ê®°ÊãüÊó•ÂøóËØ¶ÊÉÖÊï∞ÊçÆ
            const logDetails = {
                'log1': {
                    id: 'log1',
                    time: '2024-01-24 14:35:23',
                    level: 'ERROR',
                    source: 'device.pcs',
                    message: 'PCS-01ËÆæÂ§áÈÄö‰ø°Ë∂ÖÊó∂ÔºåËøûÊé•Â§±Ë¥•',
                    user: 'Á≥ªÁªü',
                    ip: '192.168.1.100',
                    details: 'TCPËøûÊé•Ë∂ÖÊó∂ÔºåËÆæÂ§áÂèØËÉΩÁ¶ªÁ∫øÊàñÁΩëÁªúÂºÇÂ∏∏„ÄÇÈîôËØØ‰ª£Á†ÅÔºöTIMEOUT_001',
                    stack: 'at DeviceConnection.connect(device.js:123)\nat DeviceManager.initialize(manager.js:45)\nat System.startup(system.js:12)'
                },
                'log2': {
                    id: 'log2',
                    time: '2024-01-24 14:32:15',
                    level: 'WARNING',
                    source: 'system.auth',
                    message: 'Áî®Êà∑Âº†Â∑•Á®ãÂ∏àËøûÁª≠3Ê¨°ÁôªÂΩïÂ§±Ë¥•',
                    user: 'Âº†Â∑•Á®ãÂ∏à',
                    ip: '192.168.1.105',
                    details: 'Áî®Êà∑Âú®Áü≠Êó∂Èó¥ÂÜÖÂ§öÊ¨°ÁôªÂΩïÂ§±Ë¥•ÔºåÂèØËÉΩÂ≠òÂú®ÂÆâÂÖ®È£éÈô©„ÄÇÂª∫ËÆÆÊ£ÄÊü•ÂØÜÁ†ÅÊàñË¥¶Êà∑Áä∂ÊÄÅ„ÄÇ',
                    stack: ''
                },
                'log3': {
                    id: 'log3',
                    time: '2024-01-24 14:30:08',
                    level: 'INFO',
                    source: 'user.operation',
                    message: 'Áî®Êà∑ÊùéËøêÁª¥ÊâßË°å‰∫ÜËÆæÂ§áÈáçÂêØÊìç‰Ωú',
                    user: 'ÊùéËøêÁª¥',
                    ip: '192.168.1.102',
                    details: 'ËÆæÂ§áID: DEV-001ÔºåÈáçÂêØÁ±ªÂûã: ËΩØÈáçÂêØÔºåÊìç‰ΩúËÄóÊó∂: 15Áßí',
                    stack: ''
                },
                'log4': {
                    id: 'log4',
                    time: '2024-01-24 14:28:45',
                    level: 'SUCCESS',
                    source: 'api.request',
                    message: 'Êï∞ÊçÆÂàÜÊûêÊä•Ë°®ÁîüÊàêÊàêÂäü',
                    user: 'Á≥ªÁªü',
                    ip: '127.0.0.1',
                    details: 'Êä•Ë°®Á±ªÂûã: ËÉΩËÄóÂàÜÊûêÔºåÊï∞ÊçÆËåÉÂõ¥: 2024-01-01 Ëá≥ 2024-01-24ÔºåÊñá‰ª∂Â§ßÂ∞è: 2.5MB',
                    stack: ''
                },
                'log5': {
                    id: 'log5',
                    time: '2024-01-24 14:25:12',
                    level: 'DEBUG',
                    source: 'system.monitor',
                    message: 'ÂÆöÊó∂‰ªªÂä°ÊâßË°åÂÆåÊàêÔºåËÄóÊó∂125ms',
                    user: 'Á≥ªÁªü',
                    ip: '127.0.0.1',
                    details: '‰ªªÂä°ÂêçÁß∞: Êï∞ÊçÆÈááÈõÜ‰ªªÂä°ÔºåÊâßË°åÂë®Êúü: 5ÂàÜÈíüÔºåÂ§ÑÁêÜËÆ∞ÂΩïÊï∞: 1024',
                    stack: ''
                }
            };

            const log = logDetails[logId] || {};
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="min-width: 600px; max-width: 800px;">
                    <div class="modal-header">
                        <h2 class="modal-title">Êó•ÂøóËØ¶ÊÉÖ</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 1rem 0;">
                        <div class="log-detail-grid">
                            <div class="detail-row">
                                <span class="detail-label">Êó∂Èó¥Ôºö</span>
                                <span class="detail-value">${log.time || ''}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Á∫ßÂà´Ôºö</span>
                                <span class="detail-value">
                                    <span class="log-level level-${log.level?.toLowerCase() || 'info'}">${log.level || ''}</span>
                                </span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Êù•Ê∫êÔºö</span>
                                <span class="detail-value log-source">${log.source || ''}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Áî®Êà∑Ôºö</span>
                                <span class="detail-value">${log.user || ''}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">IPÂú∞ÂùÄÔºö</span>
                                <span class="detail-value">${log.ip || ''}</span>
                            </div>
                            <div class="detail-row full-width">
                                <span class="detail-label">Ê∂àÊÅØÔºö</span>
                                <span class="detail-value">${log.message || ''}</span>
                            </div>
                            <div class="detail-row full-width">
                                <span class="detail-label">ËØ¶ÁªÜ‰ø°ÊÅØÔºö</span>
                                <span class="detail-value">${log.details || 'Êó†È¢ùÂ§ñ‰ø°ÊÅØ'}</span>
                            </div>
                            ${log.stack ? `
                                <div class="detail-row full-width">
                                    <span class="detail-label">Â†ÜÊ†à‰ø°ÊÅØÔºö</span>
                                    <pre class="detail-value stack-trace">${log.stack}</pre>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">ÂÖ≥Èó≠</button>
                    </div>
                </div>
            `;
            
            // Ê∑ªÂä†Ê†∑Âºè
            const style = document.createElement('style');
            style.textContent = `
                .modal {
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    align-items: center;
                    justify-content: center;
                }
                .modal-content {
                    background: white;
                    border-radius: 8px;
                    padding: 2rem;
                    max-width: 90vw;
                    max-height: 90vh;
                    overflow-y: auto;
                }
                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 1.5rem;
                    padding-bottom: 1rem;
                    border-bottom: 1px solid #e5e7eb;
                }
                .modal-title {
                    font-size: 1.25rem;
                    font-weight: 600;
                    color: #1f2937;
                }
                .close-btn {
                    background: none;
                    border: none;
                    font-size: 1.5rem;
                    cursor: pointer;
                    color: #6b7280;
                    padding: 0;
                    line-height: 1;
                }
                .close-btn:hover {
                    color: #374151;
                }
                .modal-footer {
                    display: flex;
                    justify-content: flex-end;
                    gap: 1rem;
                    margin-top: 2rem;
                    padding-top: 1rem;
                    border-top: 1px solid #e5e7eb;
                }
                .log-detail-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 1rem;
                }
                .detail-row {
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                }
                .detail-row.full-width {
                    grid-column: 1 / -1;
                }
                .detail-label {
                    font-weight: 600;
                    color: #374151;
                    font-size: 0.875rem;
                }
                .detail-value {
                    color: #1f2937;
                    font-size: 0.875rem;
                    word-break: break-word;
                }
                .stack-trace {
                    background: #f1f5f9;
                    padding: 0.75rem;
                    border-radius: 4px;
                    font-family: monospace;
                    font-size: 0.8125rem;
                    white-space: pre-wrap;
                    overflow-x: auto;
                }
            `;
            
            document.head.appendChild(style);
            document.body.appendChild(modal);
            
            // ÁÇπÂáªÊ®°ÊÄÅÊ°ÜÂ§ñÈÉ®ÂÖ≥Èó≠
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                    style.remove();
                }
            });
        }

        // Ê∏ÖÁ©∫Êó•Âøó
        function clearLogs() {
            showConfirmDialog(
                'Ê∏ÖÁ©∫Êó•Âøó',
                'Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÁ≥ªÁªüÊó•ÂøóÂêóÔºü',
                'Ê∏ÖÁ©∫ÂêéÊâÄÊúâÊó•ÂøóÊï∞ÊçÆÂ∞ÜÊ∞∏‰πÖ‰∏¢Â§±ÔºåÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§çÔºÅ',
                () => {
                    console.log('Ê∏ÖÁ©∫Êó•Âøó');
                    showMessage('Êó•ÂøóÂ∑≤Ê∏ÖÁ©∫', 'success');
                },
                'danger'
            );
        }

        // ÂØºÂá∫Êó•Âøó
        function exportLogs() {
            console.log('ÂØºÂá∫Êó•Âøó');
            showMessage('Êó•ÂøóÂØºÂá∫‰∏≠...', 'info');
            
            setTimeout(() => {
                showMessage('Êó•ÂøóÂØºÂá∫ÂÆåÊàê', 'success');
            }, 2000);
        }

        // ÂàÜÈ°µ
        function changePage(page) {
            console.log('ÂàáÊç¢Âà∞È°µÈù¢:', page);
        }

        // ÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü
        function showConfirmDialog(title, message, warning, callback, type = 'primary') {
            // ÂàõÂª∫Ê®°ÊÄÅÊ°ÜÂÖÉÁ¥†
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="min-width: 400px;">
                    <div class="modal-header">
                        <h2 class="modal-title">${title}</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 1rem 0;">
                        <div style="font-size: 0.9rem; color: #374151; line-height: 1.5;">${message}</div>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: #fef2f2; border: 1px solid #fecaca; border-radius: 6px; font-size: 0.875rem; color: #dc2626;">${warning}</div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">ÂèñÊ∂à</button>
                        <button type="button" class="btn ${type === 'danger' ? 'btn-danger' : 'btn-primary'}" onclick="confirmAction()">Á°ÆËÆ§</button>
                    </div>
                </div>
            `;
            
            // Ê∑ªÂä†Ê†∑Âºè
            const style = document.createElement('style');
            style.textContent = `
                .modal {
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    align-items: center;
                    justify-content: center;
                }
                .modal-content {
                    background: white;
                    border-radius: 8px;
                    padding: 2rem;
                    max-width: 90vw;
                    max-height: 90vh;
                    overflow-y: auto;
                }
                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 1.5rem;
                    padding-bottom: 1rem;
                    border-bottom: 1px solid #e5e7eb;
                }
                .modal-title {
                    font-size: 1.25rem;
                    font-weight: 600;
                    color: #1f2937;
                }
                .close-btn {
                    background: none;
                    border: none;
                    font-size: 1.5rem;
                    cursor: pointer;
                    color: #6b7280;
                    padding: 0;
                    line-height: 1;
                }
                .close-btn:hover {
                    color: #374151;
                }
                .modal-footer {
                    display: flex;
                    justify-content: flex-end;
                    gap: 1rem;
                    margin-top: 2rem;
                    padding-top: 1rem;
                    border-top: 1px solid #e5e7eb;
                }
                .btn-danger {
                    background: #ef4444;
                    color: white;
                }
                .btn-danger:hover {
                    background: #dc2626;
                }
            `;
            
            // Á°ÆËÆ§Êìç‰ΩúÂáΩÊï∞
            window.confirmAction = function() {
                callback();
                modal.remove();
                style.remove();
                delete window.confirmAction;
            };
            
            document.head.appendChild(style);
            document.body.appendChild(modal);
        }

        // Ê∂àÊÅØÊèêÁ§∫
        function showMessage(message, type) {
            const messageEl = document.createElement('div');
            messageEl.className = `message ${type}`;
            messageEl.textContent = message;
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 6px;
                color: white;
                font-weight: 500;
                z-index: 9999;
                transition: all 0.3s ease;
                ${type === 'success' ? 'background: #10b981;' : 
                  type === 'error' ? 'background: #ef4444;' : 
                  'background: #3b82f6;'}
            `;
            
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.style.opacity = '0';
                messageEl.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(messageEl)) {
                        document.body.removeChild(messageEl);
                    }
                }, 300);
            }, 3000);
        }

        // ÂàáÊç¢Áî®Êà∑ËèúÂçï
        function toggleUserMenu() {
            const menu = document.getElementById('userDropdownMenu');
            const btn = document.querySelector('.user-menu-btn');
            
            menu.classList.toggle('show');
            btn.classList.toggle('active');
        }

        // ÊòæÁ§∫Ë¥¶Âè∑‰ø°ÊÅØ
        function showAccountInfo() {
            toggleUserMenu(); // ÂÖ≥Èó≠‰∏ãÊãâËèúÂçï
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="min-width: 500px; max-width: 600px;">
                    <div class="modal-header">
                        <h2 class="modal-title">Ë¥¶Âè∑‰ø°ÊÅØ</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 1rem 0;">
                        <div class="account-info-grid">
                            <div class="info-section">
                                <h3 class="section-title">Âü∫Êú¨‰ø°ÊÅØ</h3>
                                <div class="info-row">
                                    <span class="info-label">Áî®Êà∑ÂêçÔºö</span>
                                    <span class="info-value">admin</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">ÂßìÂêçÔºö</span>
                                    <span class="info-value">ÁÆ°ÁêÜÂëò</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">ÈÇÆÁÆ±Ôºö</span>
                                    <span class="info-value">admin@company.com</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">ÊâãÊú∫Ôºö</span>
                                    <span class="info-value">138-0000-0000</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">ËßíËâ≤Ôºö</span>
                                    <span class="info-value">
                                        <span class="role-badge">Á≥ªÁªüÁÆ°ÁêÜÂëò</span>
                                    </span>
                                </div>
                            </div>
                            
                            <div class="info-section">
                                <h3 class="section-title">ÁôªÂΩï‰ø°ÊÅØ</h3>
                                <div class="info-row">
                                    <span class="info-label">ÊúÄÂêéÁôªÂΩïÔºö</span>
                                    <span class="info-value">2024-01-24 14:30:00</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">ÁôªÂΩïIPÔºö</span>
                                    <span class="info-value">192.168.1.100</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">ÂàõÂª∫Êó∂Èó¥Ôºö</span>
                                    <span class="info-value">2024-01-01 09:00:00</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Ë¥¶Âè∑Áä∂ÊÄÅÔºö</span>
                                    <span class="info-value">
                                        <span class="status-badge enabled">Ê≠£Â∏∏</span>
                                    </span>
                                </div>
                            </div>
                            
                            <div class="info-section full-width">
                                <h3 class="section-title">ÂÆâÂÖ®ËÆæÁΩÆ</h3>
                                <div class="security-actions">
                                    <button class="btn btn-secondary" onclick="changePassword()">‰øÆÊîπÂØÜÁ†Å</button>
                                    <button class="btn btn-secondary" onclick="updateProfile()">ÁºñËæë‰ø°ÊÅØ</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">ÂÖ≥Èó≠</button>
                    </div>
                </div>
            `;
            
            // Ê∑ªÂä†Ê†∑Âºè
            const style = document.createElement('style');
            style.textContent = `
                .account-info-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 2rem;
                }
                .info-section {
                    display: flex;
                    flex-direction: column;
                    gap: 1rem;
                }
                .info-section.full-width {
                    grid-column: 1 / -1;
                }
                .section-title {
                    font-size: 1rem;
                    font-weight: 600;
                    color: #1f2937;
                    margin-bottom: 0.5rem;
                    padding-bottom: 0.5rem;
                    border-bottom: 1px solid #f1f5f9;
                }
                .info-row {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 0.5rem 0;
                }
                .info-label {
                    font-weight: 500;
                    color: #6b7280;
                    font-size: 0.875rem;
                }
                .info-value {
                    color: #1f2937;
                    font-size: 0.875rem;
                    font-weight: 500;
                }
                .role-badge {
                    display: inline-flex;
                    align-items: center;
                    padding: 4px 12px;
                    border-radius: 20px;
                    font-size: 12px;
                    font-weight: 500;
                    background: #eff6ff;
                    color: #1d4ed8;
                }
                .status-badge.enabled {
                    display: inline-flex;
                    align-items: center;
                    padding: 4px 12px;
                    border-radius: 20px;
                    font-size: 12px;
                    font-weight: 500;
                    background: #d1fae5;
                    color: #059669;
                }
                .security-actions {
                    display: flex;
                    gap: 1rem;
                    margin-top: 1rem;
                }
            `;
            
            document.head.appendChild(style);
            document.body.appendChild(modal);
            
            // ÁÇπÂáªÊ®°ÊÄÅÊ°ÜÂ§ñÈÉ®ÂÖ≥Èó≠
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                    style.remove();
                }
            });
        }

        // ‰øÆÊîπÂØÜÁ†Å
        function changePassword() {
            showMessage('‰øÆÊîπÂØÜÁ†ÅÂäüËÉΩÂºÄÂèë‰∏≠...', 'info');
        }

        // Êõ¥Êñ∞ËµÑÊñô
        function updateProfile() {
            showMessage('ÁºñËæë‰ø°ÊÅØÂäüËÉΩÂºÄÂèë‰∏≠...', 'info');
        }

        // Á°ÆËÆ§ÈÄÄÂá∫
        function confirmLogout() {
            toggleUserMenu(); // ÂÖ≥Èó≠‰∏ãÊãâËèúÂçï
            
            showConfirmDialog(
                'ÈÄÄÂá∫ÁôªÂΩï',
                'Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÂΩìÂâçË¥¶Âè∑ÂêóÔºü',
                'ÈÄÄÂá∫ÂêéÊÇ®ÈúÄË¶ÅÈáçÊñ∞ÁôªÂΩïÊâçËÉΩÁªßÁª≠‰ΩøÁî®Á≥ªÁªü„ÄÇ',
                () => {
                    // Ê®°ÊãüÈÄÄÂá∫Êìç‰Ωú
                    showMessage('Ê≠£Âú®ÈÄÄÂá∫...', 'info');
                    setTimeout(() => {
                        window.location.href = '/login.html'; // Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÈù¢
                    }, 1000);
                },
                'primary'
            );
        }

        // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÂÖ≥Èó≠‰∏ãÊãâËèúÂçï
        document.addEventListener('click', function(e) {
            const userDropdown = document.querySelector('.user-dropdown');
            const menu = document.getElementById('userDropdownMenu');
            const btn = document.querySelector('.user-menu-btn');
            
            if (userDropdown && !userDropdown.contains(e.target)) {
                menu.classList.remove('show');
                btn.classList.remove('active');
            }
        });
    </script>

    <!-- ÂºïÂÖ•‰æßËæπÊ†èËÑöÊú¨ -->
    <script src="../sidebar.js"></script>

    <style>
        /* ÁßªÂä®Á´ØËèúÂçïÊåâÈíÆÊ†∑Âºè */
        @media (max-width: 768px) {
            .menu-toggle {
                display: block !important;
            }
        }
    
        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        .navbar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 2rem;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .page-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-button {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            transition: all 150ms ease;
        }

        .nav-button:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        /* Áî®Êà∑‰∏ãÊãâËèúÂçïÊ†∑Âºè */
        .user-dropdown {
            position: relative;
        }

        .user-menu-btn {
            position: relative;
        }

        .dropdown-arrow {
            font-size: 0.75rem;
            transition: transform 0.2s ease;
        }

        .user-menu-btn.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .user-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            min-width: 200px;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
        }

        .user-dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            cursor: pointer;
            color: #374151;
            font-size: 0.875rem;
            transition: background-color 0.15s ease;
        }

        .dropdown-item:hover {
            background: #f8fafc;
        }

        .dropdown-item.logout:hover {
            background: #fef2f2;
            color: #dc2626;
        }

        .dropdown-divider {
            height: 1px;
            background: #e2e8f0;
            margin: 0.25rem 0;
        }
    </style>

    <script>
        // Áî®Êà∑‰∏ãÊãâËèúÂçïÂäüËÉΩ
        function toggleUserMenu() {
            console.log('toggleUserMenu called'); // Ë∞ÉËØïÁî®
            const dropdown = document.getElementById('userDropdownMenu');
            const button = document.querySelector('.user-menu-btn');
            
            if (dropdown && button) {
                dropdown.classList.toggle('show');
                button.classList.toggle('active');
                console.log('Menu toggled', dropdown.classList.contains('show')); // Ë∞ÉËØïÁî®
            } else {
                console.log('Dropdown or button not found'); // Ë∞ÉËØïÁî®
            }
        }

        // ÊòæÁ§∫Ë¥¶Âè∑‰ø°ÊÅØ
        function showAccountInfo() {
            console.log('showAccountInfo called'); // Ë∞ÉËØïÁî®
            document.getElementById('userDropdownMenu').classList.remove('show');
            document.querySelector('.user-menu-btn').classList.remove('active');
            
            // ÊòæÁ§∫Áé∞ÊúâÁöÑË¥¶Âè∑‰ø°ÊÅØÊ®°ÊÄÅÊ°Ü
            const accountModal = document.getElementById('accountInfoModal');
            if (accountModal) {
                accountModal.classList.add('show');
            } else {
                console.log('Account modal not found, using existing modal'); // Ë∞ÉËØïÁî®
                // Â¶ÇÊûúÊ≤°ÊúâÊâæÂà∞‰∏ìÈó®ÁöÑË¥¶Âè∑‰ø°ÊÅØÊ®°ÊÄÅÊ°ÜÔºå‰ΩøÁî®Áé∞ÊúâÁöÑÊ®°ÊÄÅÊ°Ü
                showExistingAccountInfo();
            }
        }

        // ÊòæÁ§∫Áé∞ÊúâÁöÑË¥¶Âè∑‰ø°ÊÅØÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ
        function showExistingAccountInfo() {
            // Êü•ÁúãÊòØÂê¶ÊúâÁé∞ÊúâÁöÑË¥¶Âè∑‰ø°ÊÅØÊòæÁ§∫ÂäüËÉΩ
            alert('Ë¥¶Âè∑‰ø°ÊÅØÂäüËÉΩÂºÄÂèë‰∏≠');
        }

        // Á°ÆËÆ§ÈÄÄÂá∫
        function confirmLogout() {
            console.log('confirmLogout called'); // Ë∞ÉËØïÁî®
            document.getElementById('userDropdownMenu').classList.remove('show');
            document.querySelector('.user-menu-btn').classList.remove('active');
            
            if (confirm('ÊÇ®Á°ÆÂÆöË¶ÅÈÄÄÂá∫Á≥ªÁªüÂêóÔºü')) {
                // ËøôÈáåÂ∫îËØ•Ë∞ÉÁî®ÂêéÁ´ØAPIÈÄÄÂá∫ÁôªÂΩï
                alert('Ê≠£Âú®ÈÄÄÂá∫...');
                setTimeout(() => {
                    window.location.href = '../../index.html';
                }, 1000);
            }
        }

        // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠‰∏ãÊãâËèúÂçï
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('userDropdownMenu');
            const button = document.querySelector('.user-menu-btn');
            
            if (dropdown && button && !button.contains(event.target)) {
                dropdown.classList.remove('show');
                button.classList.remove('active');
            }
        });

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÁöÑÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, checking elements');
            const dropdown = document.getElementById('userDropdownMenu');
            const button = document.querySelector('.user-menu-btn');
            console.log('Dropdown found:', !!dropdown);
            console.log('Button found:', !!button);
        });
    </script>

</body>
</html>